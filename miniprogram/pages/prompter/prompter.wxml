<view class="container-prompter" style="background-color: {{bgColor}};">
  
  <!-- Header -->
  <view class="header" style="padding-top: {{statusBarHeight}}px; opacity: {{isRunning ? 0 : 1}}; pointer-events: {{isRunning ? 'none' : 'auto'}};">
    <view class="left-group">
      <view class="icon-btn" bindtap="goBack">
        <text class="icon">â†</text>
      </view>
      <view class="icon-btn" bindtap="toggleSettings">
        <text class="icon">âš™ï¸</text>
      </view>
    </view>
    
    <view class="mode-switch">
      <view class="mode-item {{mode === 'basic' ? 'active' : ''}}" bindtap="switchMode" data-mode="basic">åŸºç¡€</view>
      <view class="mode-item {{mode === 'smart' ? 'active' : ''}}" bindtap="switchMode" data-mode="smart">è·Ÿéš</view>
    </view>

    <view class="right-placeholder"></view>
  </view>

  <!-- Focus Line Indicator -->
  <view class="focus-line-container" style="top: {{baselinePercent}}%;">
    <view class="focus-arrow">â–¶</view>
    <view class="focus-line"></view>
  </view>

  <!-- Focus Masks (Dimming Effect) -->
  <view wx:if="{{focusEnabled}}" class="focus-mask-top" style="height: {{baselinePercent - 10}}%; background: linear-gradient(to bottom, {{bgColor}} 30%, transparent 100%);"></view>
  <view wx:if="{{focusEnabled}}" class="focus-mask-bottom" style="top: {{baselinePercent + 10}}%; height: {{100 - (baselinePercent + 10)}}%; background: linear-gradient(to top, {{bgColor}} 30%, transparent 100%);"></view>

  <!-- Prompter Text Area -->
  <view 
    class="prompter-viewport"
    bindtouchstart="onTouchStart"
    bindtouchmove="onTouchMove"
    bindtouchend="onTouchEnd"
    bindtap="onScreenTap"
  >
    <view 
      class="prompter-content"
      style="transform: translateY({{offsetY}}px); transition: {{transitionStyle}};"
    >
      <!-- Dynamic Padding based on Baseline -->
      <view class="padding-space" style="height: {{baselinePercent}}vh;"></view>
      
      <view class="text-content" style="font-size: {{fontSize}}px; line-height: {{lineHeight}}; letter-spacing: {{letterSpacing}}px; color: {{fontColor}};">
        <text>{{content}}</text>
      </view>

      <view class="padding-space" style="height: {{100 - baselinePercent}}vh;"></view>
    </view>
  </view>

  <!-- AI Status Indicator (Fixed at Bottom) -->
  <view wx:if="{{mode === 'smart' && isRunning}}" class="ai-feedback-fixed">
    <text class="ai-status">ğŸ™ï¸ AI æ­£åœ¨è†å¬...</text>
  </view>

  <!-- Countdown Overlay -->
  <view class="countdown-overlay" wx:if="{{countdown > 0}}">
    <text class="countdown-text">{{countdown}}</text>
  </view>

  <!-- Bottom Controls -->
  <view class="controls" wx:if="{{!isRunning && countdown === 0}}">
    <block wx:if="{{mode === 'basic'}}">
      <view class="btn-play-round" bindtap="startBasicScroll">
        <view class="icon-play"></view>
      </view>
    </block>

    <block wx:if="{{mode === 'smart'}}">
      <view class="btn-play-round btn-play-ai" bindtap="startSmartFollow">
        <view class="icon-play"></view>
      </view>
    </block>
  </view>

  <!-- Settings Panel -->
  <view class="settings-panel" wx:if="{{showSettings}}">
    <scroll-view scroll-y="true" style="max-height: 60vh;">
      <view class="setting-group">
        <view class="setting-title">æ˜¾ç¤ºè®¾ç½®</view>
        <view class="setting-item">
          <text>å­—å· ({{fontSize}}px)</text>
          <slider min="20" max="80" value="{{fontSize}}" bindchange="onFontSizeChange" />
        </view>
        <view class="setting-item">
          <text>è¡Œé—´è· ({{lineHeight}})</text>
          <slider min="1.0" max="3.0" step="0.1" value="{{lineHeight}}" bindchange="onLineHeightChange" />
        </view>
        <view class="setting-item">
          <text>å­—é—´è· ({{letterSpacing}}px)</text>
          <slider min="0" max="10" step="1" value="{{letterSpacing}}" bindchange="onLetterSpacingChange" />
        </view>
         <view class="setting-item">
          <text>åŸºå‡†çº¿ä½ç½® ({{baselinePercent}}%)</text>
          <slider min="20" max="80" step="5" value="{{baselinePercent}}" bindchange="onBaselineChange" />
        </view>
         <view class="setting-item switch-item">
          <text>å°æœ¬èšç„¦æ¨¡å¼</text>
          <switch checked="{{focusEnabled}}" bindchange="onFocusToggle" />
        </view>
      </view>

      <view class="setting-group" wx:if="{{mode === 'basic'}}">
        <view class="setting-title">æ»šåŠ¨è®¾ç½®</view>
        <view class="setting-item">
          <text>å¼€å§‹å€’è®¡æ—¶ ({{countdownDuration}}ç§’)</text>
          <slider min="0" max="10" value="{{countdownDuration}}" bindchange="onCountdownDurationChange" />
        </view>
        <view class="setting-item">
          <text>æ»šåŠ¨é€Ÿåº¦ ({{speed}})</text>
          <slider min="1" max="20" value="{{speed}}" bindchange="onSpeedChange" />
        </view>
      </view>

      <view class="setting-group">
        <view class="setting-title">é¢œè‰²è®¾ç½®</view>
        <view class="color-row">
          <text>æ–‡å­—ï¼š</text>
          <view class="color-options">
            <view class="color-circle" style="background:white" bindtap="setFontColor" data-color="#ffffff"></view>
            <view class="color-circle" style="background:black" bindtap="setFontColor" data-color="#000000"></view>
            <view class="color-circle" style="background:#ffd700" bindtap="setFontColor" data-color="#ffd700"></view>
          </view>
        </view>
        <view class="color-row">
          <text>èƒŒæ™¯ï¼š</text>
          <view class="color-options">
            <view class="color-circle" style="background:black; border: 1px solid #333;" bindtap="setBgColor" data-color="#000000"></view>
            <view class="color-circle" style="background:white; border: 1px solid #ccc;" bindtap="setBgColor" data-color="#ffffff"></view>
            <view class="color-circle" style="background:#00b140" bindtap="setBgColor" data-color="#00b140"></view>
          </view>
        </view>
      </view>
    </scroll-view>

    <button class="btn-close-settings" bindtap="toggleSettings">å…³é—­</button>
  </view>
</view>